# lm.contribution, lm.contribution.ggplot

x <- structure(list(Week = structure(c(16069, 16076, 16083, 16090, 
                                  16097, 16104, 16111, 16118, 16125, 16132, 16139, 16146, 16153, 
                                  16160, 16167, 16174, 16181, 16188, 16195, 16202, 16209, 16216, 
                                  16223, 16230, 16237, 16244, 16251, 16258, 16265, 16272, 16279, 
                                  16286, 16293, 16300, 16307, 16314, 16321, 16328, 16335, 16342, 
                                  16349, 16356, 16363, 16370, 16377, 16384, 16391, 16398, 16405, 
                                  16412, 16419, 16426, 16433, 16440, 16447, 16454, 16461, 16468, 
                                  16475, 16482, 16489, 16496, 16503, 16510, 16517, 16524, 16531, 
                                  16538, 16545, 16552, 16559, 16566, 16573, 16580, 16587, 16594, 
                                  16601, 16608, 16615, 16622, 16629, 16636, 16643, 16650, 16657, 
                                  16664, 16671, 16678, 16685, 16692, 16699, 16706, 16713, 16720, 
                                  16727, 16734, 16741, 16748, 16755, 16762, 16769, 16776, 16783, 
                                  16790, 16797), class = "Date"), TotalGrossLeads = c(30L, 85L, 
                                                                                      66L, 76L, 118L, 189L, 374L, 373L, 398L, 493L, 532L, 550L, 618L, 
                                                                                      598L, 532L, 552L, 870L, 856L, 932L, 826L, 792L, 766L, 875L, 823L, 
                                                                                      614L, 661L, 874L, 902L, 862L, 967L, 1087L, 1052L, 1156L, 1213L, 
                                                                                      949L, 908L, 973L, 1086L, 1122L, 1196L, 1089L, 1269L, 1202L, 821L, 
                                                                                      970L, 1106L, 1075L, 1023L, 804L, 748L, 523L, 350L, 707L, 1284L, 
                                                                                      1484L, 1810L, 1725L, 1807L, 1699L, 1286L, 1372L, 1882L, 1099L, 
                                                                                      1075L, 1180L, 1802L, 1544L, 1233L, 1134L, 1304L, 1491L, 1219L, 
                                                                                      1283L, 1287L, 1734L, 1371L, 1284L, 1078L, 1263L, 1205L, NA, NA, 
                                                                                      NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, 
                                                                                      NA, NA, NA, NA, NA, NA, NA), TotalMediaSpend = c(7794.73, 844.72, 
                                                                                                                                       1478.33, 2666.75, 2991.93, 80345.6, 92254.4, 63030.87, 89262.75, 
                                                                                                                                       91031.52, 33228.66, 86358.73, 73505.83, 48222.65, 79053.51, 51695.43, 
                                                                                                                                       52452.68, 52877.4, 52736.19, 47608.29, 43206.16, 55677.25, 73881.13, 
                                                                                                                                       36094.5, 30036.06, 35531.61, 59970.13, 46089.46, 50444.52, 39137.23, 
                                                                                                                                       39116.5, 43770.37, 47883.39, 54743.82, 60009.23, 46244.49, 45578.55, 
                                                                                                                                       61474.08, 59578.11, 65666.87, 65763.2, 49627.41, 44933.52, 31687.72, 
                                                                                                                                       49688.37, 43096.31, 95961.11, 112251.01, 81872.7, 54528.48, 14349.71, 
                                                                                                                                       5612.6, 11749.27, 64652.14, 45156.69, 432095.54524, 402790.057756, 
                                                                                                                                       365732.356568, 256455.87894, 72461.829524, 255102.467924, 75049.32998, 
                                                                                                                                       230508.0761, 58514.040788, 228638.211032, 70947.659848, 163145.33924, 
                                                                                                                                       74776.15874, 55523.094676, 59015.383028, 38564.21, 41257.94, 
                                                                                                                                       46034.58, 45692.57, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                                                                                                                                       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0), Search.Spend = c(309.5, 
                                                                                                                                                                                                            844.72, 1478.33, 2666.75, 2991.93, 8011.57, 10724.92, 10592.2, 
                                                                                                                                                                                                            8824.88, 11570.23, 11929.79, 12256.21, 11667.26, 12545.72, 12243.96, 
                                                                                                                                                                                                            16361.18, 18664.02, 17987.26, 23413.58, 18766.71, 18147.15, 6820.56, 
                                                                                                                                                                                                            16596.82, 9175.7, 3117.21, 7454.93, 10107.46, 19816.37, 26704.48, 
                                                                                                                                                                                                            17109.8, 17744.46, 18085.28, 26237.46, 25405.7, 19959.33, 19783.6, 
                                                                                                                                                                                                            11663.29, 26071.46, 29282.93, 32169.3, 29775.55, 22456.99, 22688.64, 
                                                                                                                                                                                                            11186.65, 23350.44, 28044.8, 32577.13, 29260.37, 18211.67, 13076.47, 
                                                                                                                                                                                                            2148.47, 1076.18, 2048.43, 23995.24, 24761.9, 39072.91, 40350.16, 
                                                                                                                                                                                                            36824.77, 28102.26, 22000.34, 25888.07, 31616.01, 30297.03, 39630.05, 
                                                                                                                                                                                                            45931.19, 45568.18, 40751.21, 37235.16, 34529.52, 34280.29, 30685.35, 
                                                                                                                                                                                                            22181.44, 26137.54, 28470.69, NA, NA, NA, NA, NA, NA, NA, NA, 
                                                                                                                                                                                                            NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, 
                                                                                                                                                                                                            NA, NA, NA, NA, NA, NA, NA), Competitor.Spend = c(68253L, 15292L, 
                                                                                                                                                                                                                                                              21247L, 19218L, 398136L, 8913L, 21436L, 25480L, 111573L, 22313L, 
                                                                                                                                                                                                                                                              86414L, 142313L, 153344L, 129720L, 38352L, 37273L, 56740L, 263671L, 
                                                                                                                                                                                                                                                              44696L, 46095L, 38587L, 419744L, 194118L, 92214L, 30111L, 37879L, 
                                                                                                                                                                                                                                                              269043L, 95756L, 90460L, 64512L, 240092L, 83596L, 78736L, 71012L, 
                                                                                                                                                                                                                                                              55614L, 317275L, 67514L, 223011L, 235099L, 1997624L, 628322L, 
                                                                                                                                                                                                                                                              577169L, 207668L, 770689L, 167117L, 444552L, 57285L, 347522L, 
                                                                                                                                                                                                                                                              110132L, 4220L, NA, NA, 469645L, 471010L, 420328L, 424355L, 617264L, 
                                                                                                                                                                                                                                                              316127L, 337358L, 95475L, 676697L, 139263L, 142829L, 151148L, 
                                                                                                                                                                                                                                                              176661L, 226870L, 120319L, 225701L, 192390L, 564728L, 167992L, 
                                                                                                                                                                                                                                                              170697L, 143862L, 250208L, 456131L, 176778L, 134277L, 156988L, 
                                                                                                                                                                                                                                                              749043L, 142618L, 112802L, 148646L, 138625L, 85854L, 95424L, 
                                                                                                                                                                                                                                                              108991L, 147325L, 72791L, 71873L, NA, NA, NA, NA, NA, NA, NA, 
                                                                                                                                                                                                                                                              NA, NA, NA, NA, NA, NA, NA, NA, NA)), .Names = c("Week", "TotalGrossLeads", "TotalMediaSpend", "Search.Spend", "Competitor.Spend"), row.names = c(NA, -105L), class = c("data.table", "data.frame"), sorted = "Week")

lm.x <- lm(TotalGrossLeads ~ Search.Spend + Competitor.Spend, data = x)

# addMissingDates

x <- structure(list(Date = structure(c(16436, 16437, 16439, 16440), class = "Date"), 
                    Guardian = c(0L, 0L, 20L, 0L), Metro = c(10L, 10L, 0L, 10L
                    ), Telegraph = c(0L, 0L, 0L, 5L), Times = c(15L, 0L, 0L, 
                                                                12L)), .Names = c("Date", "Guardian", "Metro", "Telegraph", 
                                                                                  "Times"), row.names = c(NA, -4L), class = c("data.table", "data.frame"
                                                                                  ), sorted = "Date")

addMissingDates(x = x, date.index = "Date")

# wideToLong

x <- structure(list(Date = c("01/01/2015", "02/01/2015", "03/01/2015", 
                             "04/01/2015", "05/01/2015"), Guardian = c(0L, 0L, 0L, 20L, 0L
                             ), Metro = c(10L, 10L, 0L, 0L, 10L), Telegraph = c(0L, 0L, 0L, 
                                                                                0L, 5L), Times = c(15L, 0L, 0L, 0L, 12L)), .Names = c("Date", 
                                                                                                                                      "Guardian", "Metro", "Telegraph", "Times"), row.names = c(NA, 
                                                                                                                                                                                                -5L), class = c("data.table", "data.frame"))
wideToLong(x = x, id.vars = "Date", writeToClipboard = FALSE)